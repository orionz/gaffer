#!/usr/bin/env ruby

require File.dirname(__FILE__) + '/../lib/gaffer'

require 'optparse'

options = {}

optparse = OptionParser.new do|opts|
  opts.banner = <<banner
Usage: gaffer [options] ACTION [ DIR [ DIR [ ... ] ] ] 
banner

  opts.on( '-f', '--force', 'Force an action' ) do
    options[:force] = true
  end

  opts.on( '-h', '--help', 'Display this screen' ) do
    puts opts
    exit
  end
end

optparse.parse!

command = ARGV.shift
target  = ARGV.shift || Dir::pwd

gaffer = Gaffer::Base.new(options)

case command
when "initrepo"
  gaffer.repro.init
when "pull"
  gaffer.repro.pull
when "build"
  gaffer.build(target)
when "push"
  gaffer.repro.push
when "add"
  gaffer.add(target)
when "publish"
  gaffer.push gaffer.compile(target)
else
  puts "No action: --help for help [#{command}]"
  exit 1
end


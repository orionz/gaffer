#!/usr/bin/env ruby

require File.dirname(__FILE__) + '/../lib/gaffer'

require 'optparse'

optparse = OptionParser.new do|opts|
  opts.banner = <<banner
Usage: gaffer [options] ACTION [ DIR [ DIR [ ... ] ] ] 
banner

  opts.on( '-h', '--help', 'Display this screen' ) do
    puts opts
    exit
  end
end

optparse.parse!

command = ARGV.shift
target  = ARGV.shift || Dir::pwd

gaffer = Gaffer::Base.new

case command
when "pull"
  gaffer.pull
when "build"
  gaffer.compile(target)
when "upload"
  gaffer.upload(target)
when "publish"
  gaffer.upload gaffer.compile(target)
else
  puts "No action: --help for help [#{command}]"
  exit 1
end

